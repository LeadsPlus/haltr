<%= error_messages_for 'invoice' %>

<div class="box">
  <p><%= f.select :client_id, clients_for_select, :required => true %></p>
  <p><%= f.text_field :date, :size => 10, :required => true %><%= calendar_for('invoice_date') %></p>
  <% if controller.controller_name == "invoice_templates" -%>
    <p><%= f.text_field :frequency, :required => true %></p>
  <% else -%>
    <p><%= f.text_field :number, :size => 10, :required => true %><%=" Last used: #{InvoiceDocument.last_number(@project)}" if InvoiceDocument.all.any?%></p>
  <% end -%>
  <p><%= f.text_field :ponumber %></p>
  <p><%= f.text_field :terms %></p>
  <p><%= f.text_field :due_date, :size => 10, :readonly => true %></p>
  <p><%= f.text_field :tax_percent %></p>
  <p><%= f.text_field :discount_text %></p>
  <p><%= f.text_field :discount_percent %></p>
  <p><%= f.text_area :extra_info, :rows=>3 %></p>
  <p><%= f.check_box :draft %></p>
  <p><%= f.check_box :use_bank_account %></p>
  <div id="invoice_lines">
    <p style="font-weight:bold;">
    <%= l(:field_quantity) %>
    <%= l(:field_description) %>
    <%= l(:field_price_in_cents) %>
    </p>
    <% f.fields_for :invoice_lines do |line_form| %>
      <%= render :partial => 'invoices/invoice_line', :locals => { :f => line_form } %>
    <% end %>
  </div>
  <p><%= add_invoice_line_link(f) %></p>
</div>

